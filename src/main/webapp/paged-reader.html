<div id="main" class="lift:surround?with=reader-internal;at=content">

<div id="image-dialog"
     style="position: absolute; top: 0; z-index: 100; background: #000; opacity: 0.98; width: 100%; height: 100%; visibility: hidden">
</div>

<div id="image-place" style="white-space: nowrap; position: absolute; top: 0; z-index: 101; width: 100%; height: 100%; visibility: hidden; vertical-align: middle">
</div>

    <!----------------- Книга --------------------->
    <div id="book-region" class="book-region" style="width: 100%;">

        <!----------------- Заголовок --------------------->
        <div id="page-header" style="width: 100%; paddin: 0px; margin: 0px;">

            <div class="row" style="width: 100%; padding: 0; margin: 0;">

                <div class="col-md-1 col-xs-1" style="text-align: center; padding: 0; margin: 0;">
                </div>

                <div class="col-md-10 col-xs-10" style="text-align: center; padding: 0; margin: 0;">

                    <div id="top-panel"
                         style="text-align: left; width: 100%; padding: 5px; color: #333; margin: 0px;
                          border-bottom: 0px solid">

                        <span id="page-title"></span>
                        <span id="page-number"></span>


                        <a id="page-backward" href="#">
                            <span class="glyphicon glyphicon-arrow-left"></span>
                            назад
                        </a>

                        <span>&nbsp;</span>

                        <a href="#" id="goto-home">
                            <span class="glyphicon glyphicon-home"></span>
                        </a>

                        <a href="#" id="show-contents" data-toggle="modal" data-target="#contents-modal">
                            <span class="glyphicon glyphicon-list"></span>
                        </a>

                        <a href="#" id="show-options">
                            <span class="glyphicon glyphicon-font"></span>
                        </a>

                        <a href="#" id="translate">
                            <span class="glyphicon glyphicon-globe"></span>
                            Перевод
                        </a>

                    </div>
                </div>

                <div class="col-md-1 col-xs-1" style="text-align: center; padding: 0; margin: 0;">
                </div>
            </div>
        </div>

        <!----------------- Страница --------------------->
        <div id="page-region" class="row" style="width: 100%; padding: 0; margin: 0;">

            <div class="col-md-1 col-xs-1 direction-column" id="left-column"
                    style="background: url(images/arrow-left.png) center center no-repeat; opacity: 0.3">

            </div>

            <div id="page" class="col-md-10 col-xs-10" style="padding: 0; margin: 0;">
                <div id="page-content" style="padding: 0; margin: 0; border: 0px solid">
                </div>

                <div id="tip-dialog" style="font-size: inherit; font-family: inherit">
                    <div id="tip-dialog-content" style="font-size: inherit; font-family: inherit">
                    </div>
                </div>


            </div>

            <div class="col-md-1 col-xs-1 direction-column" id="right-column"
                 style="background: url(images/arrow-right.png) center center no-repeat; opacity: 0.3">
            </div>

        </div>

        <!----------------- Зона появления бегунка --------------------->
        <div id="page-bottom" style="height: 44px; width: 100%; clear: both;">
            &nbsp;
        </div>

    </div>

    <!----------------- Бегунок --------------------->
    <div id="bottom-panel" style="color: #fff">

        <div class="row" style="width: 100%; padding: 0; margin: 0;">

            <div class="col-md-11 col-xs-11">
                <div id="slider" style="margin-top: 3px"></div>
            </div>
            <div class="col-md-1 col-xs-1">
                <span id="pie-span"></span><span>%</span>
            </div>
        </div>

    </div>

    <!----------------- Модал содержимого --------------------->
    <div class="modal fade" id="contents-modal" tabindex="-1" role="dialog" aria-labelledby="contents-modal-label"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <span class="lift:MyLib.readBookTitle modal-title book-title" id="contents-modal-label"
                            style="font-size: 14pt">
                        Содержимое
                    </span>
                </div>

                <div class="modal-body" id="contents-modal-body">
                </div>
            </div>
        </div>
    </div>

    <!----------------- Модал опций --------------------->
    <div id="options-dialog" style="display: none; max-width: 350px; text-align: center; font-family: 'Open Sans'; font-size: 12pt">

        <span>Оформление</span>
        <span id="close-option" class="pull-right glyphicon glyphicon-remove" style="cursor: pointer"></span>

        <br><br>

        <form class="" role="form">

            <select id="option-font-family" style="min-width: 150px; max-width: 300px; height: 32px">
                <option value="Arial">Arial</option>
                <option value="Open Sans">Open Sans</option>
                <option value="Georgia">Georgia</option>
            </select><br><br>

            <select id="option-font-size" style="min-width: 150px; max-width: 300px; height: 32px">
                <option value="8pt">8 pt</option>
                <option value="9pt">9 pt</option>
                <option value="10pt">10 pt</option>
                <option value="11pt">11 pt</option>
                <option value="12pt">12 pt</option>
                <option value="13pt">13 pt</option>
                <option value="14pt">14 pt</option>
                <option value="16pt">16 pt</option>
            </select><br><br>


            <div class="text-center">
                <div class="btn-group btn-group-sm">
                    <button type="button" class="btn btn-default" id="option-align-left">
                        <span class="glyphicon glyphicon-align-left"></span>
                    </button>

                    <button type="button" class="btn btn-default" id="option-align-justify">
                        <span class="glyphicon glyphicon-align-justify"></span>
                    </button>
                </div>
            </div><br>

            <div class="text-center">
                <div class="btn-group btn-group-sm">
                    <button type="button" class="btn btn-default" id="option-theme-white"
                            style="background: #fff">
                        <span class="glyphicon glyphicon-font"></span>
                    </button>
                    <button type="button" class="btn btn-default" id="option-theme-sepia"
                            style="background: #ebc532">
                        <span class="glyphicon glyphicon-font"></span>
                    </button>
                    <button type="button" class="btn btn-default" id="option-theme-oldschool"
                            style="background: #3937ff; color: #fff">
                        <span class="glyphicon glyphicon-font"></span>
                    </button>
                </div>
            </div>

        </form>
    </div>

    <!----------------- Скрипты --------------------->
    <script id="paged-reader" src="/js/paged-reader.js" type="text/javascript"></script>
    <script id="paginator" src="/js/paginator.js" type="text/javascript"></script>

    <span class="lift:MyLib.readBookParams"></span>

    <script type="text/javascript">

        /*$("#page-region").click(function(e) {
            var s = window.getSelection();
            var range = s.getRangeAt(0);
            var node = s.anchorNode;
            while (range.toString().indexOf(' ') != 0) {
                range.setStart(node, (range.startOffset - 1));
            }
            range.setStart(node, range.startOffset + 1);
            do {
                range.setEnd(node, range.endOffset + 1);

            } while (range.toString().indexOf(' ') == -1 && range.toString().trim() != '' && range.endOffset < node.length);
            var str = range.toString().trim();
            alert(str);
        });*/

       //

        var reader = pagedReader({
            bookId: bookId,
            lastPosition: lastPosition,
            fontFamily: fontFamily,
            fontSize: fontSize,
            textAlign: textAlign,
            theme: theme,
            link: link
        });


        function modalImage(src) {
            $( "#image-place" ).empty();

            $( "#image-place" ).append(
                $("<span style='display: inline-block; height: 100%; vertical-align: middle;'></span>")
            )
            $( "#image-place" ).append(
                    $("<img src='" + src + "' style='background: #fff; vertical-align: middle; max-width:"
                            + document.body.clientWidth
                            +  "px; max-height:"
                            + document.body.clientHeight + "px'/>")
            );
            $( "#image-dialog" ).css('visibility', 'visible');
            $( "#image-place" ).css('visibility', 'visible');
        }

        $( "#image-dialog" ).click(function() {
            $( "#image-dialog" ).css('visibility', 'hidden');
            $( "#image-place" ).css('visibility', 'hidden');
        });

        $( "#image-place" ).click(function() {
            $( "#image-dialog" ).css('visibility', 'hidden');
            $( "#image-place" ).css('visibility', 'hidden');
        });


    </script>

</div>